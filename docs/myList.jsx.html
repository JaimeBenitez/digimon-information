<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: myList.jsx</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: myList.jsx</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @file myList.jsx - My List Page
 * @author Jaime Benitez
 * @see &lt;a href="https://jaimebenitez.com" target="_blank">Jaime Benitez &lt;/a>
 */


import React, {useState, useEffect} from "react";
import ModeButton from "./mode-button";
import Logo from "./logo";
import Button from "./button";
import BackArrow from "./back-arrow";



/**
* Componente que renderiza la pantalla de lista de favoritos. &lt;br/>
* Funcionalidades: &lt;br/>
* - handleClicked(): Función que cambia el estado de IsClicked y nos permite mostrar la tarjeta del digimon &lt;br/>
* - digimonDelete(digimon: El digimon a borrar): Función que nos permite cambiar el estado de la lista de digimon, borrando el digimon elegido &lt;br/>
* - handleDelete(e: El evento con el que se activa la función, en este caso un click ,digimon: El digimon que queremos borrar): Funcion que nos permite activar con un click la función de borrar digimon, mostrándonos antes un mensaje de confirmación &lt;br/>
* - handleDigimonBack(): Función que nos permite hacer desaparecer con un click la tarjeta de digimon en modo responsive  &lt;br/>
* - handleSubmit(e: Evento que activa la función, en este caso un click): Función que activa la tarjeta asociada al digimon que se está clickando &lt;br/>
* - fetchData(digimonName: El nombre del digimon a mostrar): Función asíncrona que realiza una llamada a la api usando el nombre del digimon clickado 
* @returns {JSX} 
*      
*/
function MyList () {
  
  const [result,setResult] = useState(undefined); 
  const [isClicked,setIsClicked] = useState(false);   
  const [digimonList,setDigimonList] = useState(localStorage.getItem("digimonlist") ? localStorage.getItem("digimonlist").split(",") : []);
    
  function handleClicked(){
    setIsClicked(true);
  }
  
  function digimonDelete(digimon){ 
    //OJO - Si hacemos newDigimonList = digimonList nos dara problemas porque hara los cambios a la vez en ambas listas y el renderizado fallara
    //Esta es la mejor manera de clonar un array de manera segura
    let newDigimonList = [].concat(digimonList)  
    for(let i=0; i&lt;digimonList.length; i++){
      if(newDigimonList[i] === digimon){
        newDigimonList.splice(i, 1);        
      }
    }    
    setDigimonList(newDigimonList);
    localStorage.setItem("digimonlist", digimonList);        
  }  
  
  function handleDelete(e,digimon){  
    e.preventDefault() 
    if(window.confirm("Are you sure you want to delete this digimon?")){
    digimonDelete(digimon)
    }
  }
  
  function handleDigimonBack(){
    setIsClicked(false); //Esto nos permitirá hacer desaparecer la tarjeta en responsive
    setResult(undefined); 
  }
  
  function handleSubmit(e){ 
    e.preventDefault();
    handleClicked();    
    const { target } = e;
    const { value } = target;  
    fetchData(value)
  }
  
  async function fetchData (digimonName){    
    if(digimonName){
      let url = `https://digimon-api.vercel.app/api/digimon/name/${digimonName}`      
      try {      
        const response = await fetch(url);
        if(response.status === 200){
          const json = await response.json();    
          setResult(json);    
        }                            
      } catch (error) {                
          console.log("error", error);
      }
    }else{
      //Si no recibe un nombre no devuelve nada
      return
    }  
  } 
    
  useEffect(() =>{       
    fetchData()    
  }, []);   
  
  return(
    //Como en esta pagina si tenemos un header usamos una empty tag para devolver mas de un elemento
    &lt;>
    &lt;header id="myList__header">
      &lt;ModeButton isMyList={true}/> 
      &lt;div>          
        &lt;Logo isMyList={true}/>
        &lt;span className="myList__title">My saved list&lt;/span>
      &lt;/div>    
    &lt;/header>
    &lt;main id="myList__main">             
      &lt;section id="myList">        
        &lt;form className="myList__names">  
            {/* Para poder pasar parametros en el onClick es necesario crear una funcion anonima en el mismo onclick */}
        {digimonList.map((digimon,index) =>(
          
          &lt;div key={index} className="myList__nameList">            
            &lt;button type="submit" className="myList__deleteButton" onClick={(e) => handleDelete(e,digimon)} value={digimon}>&lt;img src={require("../assets/img/delete.svg").default} className="svg myList__delete" alt="delete" />&lt;/button>
            &lt;button  type="submit" className= "myList__digimon" onClick={handleSubmit} value={digimon}>{digimon}&lt;/button>            
          &lt;/div>
        ))
        }                 
        &lt;/form> 
        {          
          result  ?
          //Al devolvernos un array es necesario sacar el indice 0 del resultado
          &lt;div className={isClicked ? 'myList__output' : 'output-hide'} >
                &lt;span className="myList__output--title">{result[0].name}&lt;/span>
                &lt;section className="myList__output--section">
                &lt;img src={result[0].img} className="myList__output--img" alt='digimon img'/>  
                &lt;/section> 
                &lt;section className="myList__output--section">  
                    &lt;span className="myList__output--subtitle">Level&lt;/span>           
                    &lt;span className="myList__output--text"> {result[0].level}&lt;/span>                    
                &lt;/section>
                
                &lt;button  className="digimon__back" onClick={handleDigimonBack}>&lt;img src={require('../assets/img/back-arrow.svg').default} className="digimon__arrow"  alt='back'/>&lt;/button>                
          &lt;/div>
          :
          &lt;div className={isClicked ? 'output-hide' : 'myList__img__container'}>
            &lt;picture>
              &lt;source
                media="(min-width: 980px)"
                srcSet={require("../assets/img/wallpaper.jpg")}/>                            
              &lt;source srcSet={require("../assets/img/Omegamon_tri.png")}/>
              &lt;img src={require("../assets/img/wallpaper.jpg")} className="myList__img" alt="digimon" />   
            &lt;/picture>    
        &lt;/div> 
        }               
      &lt;/section>      
      &lt;nav className="list__nav">
            &lt;Button direction="list" id="myList__toList">List&lt;/Button>
            &lt;BackArrow />
      &lt;/nav>
    &lt;/main>
    &lt;/>
  )

};

export default MyList;</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#Button">Button</a></li><li><a href="global.html#Contact">Contact</a></li><li><a href="global.html#DigimonCard">DigimonCard</a></li><li><a href="global.html#Index">Index</a></li><li><a href="global.html#List">List</a></li><li><a href="global.html#LoggedButton">LoggedButton</a></li><li><a href="global.html#Login">Login</a></li><li><a href="global.html#LoginForm">LoginForm</a></li><li><a href="global.html#Logo">Logo</a></li><li><a href="global.html#ModeButton">ModeButton</a></li><li><a href="global.html#MyList">MyList</a></li><li><a href="global.html#Navbar">Navbar</a></li><li><a href="global.html#NotLoggedButton">NotLoggedButton</a></li><li><a href="global.html#PrincipalButton">PrincipalButton</a></li><li><a href="global.html#PrincipalImage">PrincipalImage</a></li><li><a href="global.html#Register">Register</a></li><li><a href="global.html#RegisterForm">RegisterForm</a></li><li><a href="global.html#Suggestions">Suggestions</a></li><li><a href="global.html#User">User</a></li><li><a href="global.html#UserData">UserData</a></li><li><a href="global.html#backArrow">backArrow</a></li><li><a href="global.html#emailRegexp">emailRegexp</a></li><li><a href="global.html#levels">levels</a></li><li><a href="global.html#passwordRegexp">passwordRegexp</a></li><li><a href="global.html#suggestionRegexp">suggestionRegexp</a></li><li><a href="global.html#usernameRegexp">usernameRegexp</a></li><li><a href="global.html#usuariosRegistrados">usuariosRegistrados</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.0</a> on Fri Jan 13 2023 17:19:22 GMT+0100 (hora estándar de Europa central)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
